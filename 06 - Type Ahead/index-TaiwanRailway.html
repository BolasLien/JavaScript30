<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Type Ahead ğŸ‘€</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <form class="search-form">
    <input type="text" class="search" placeholder="ç«™åæˆ–åœ°å€">
    <ul class="suggestions">
      <li>è«‹è¼¸å…¥ç«™åæˆ–åœ°å€</li>
      <!-- <li></li> -->
    </ul>
  </form>
<script>
// å°éµè»Šç«™åˆ—è¡¨
const endpoint = 'https://gist.githubusercontent.com/salhk/cd9e808f6467f45967749b839ac4f7fb/raw/8aadc1bd5dbc4f040baf613f9a4f3928af1e28cc/TRAStations.json'

const stations = []

// å¾ç¶²å€å–å¾—è»Šç«™è³‡æ–™
fetch(endpoint)
  .then(res=> res.json())
  .then(data=> stations.push(...data))

// // æ‰¾åˆ°ç¬¦åˆçš„è³‡æ–™æ–‡å­—
function findMatches(wordToMatch, stations){
  return stations.filter(place=>{
    const regex = new RegExp(wordToMatch, 'gi')
    return place.Station_Name.match(regex) || place.ä½å€.match(regex) || place.ç¶²ç«™ä¸­æ–‡ç«™å.match(regex)
  })
}

// é¡¯ç¤ºåœ¨ç•«é¢ä¸­
function displayMatches(){
  const result = findMatches(this.value, stations)

  const html = result.map(place=>{
    const regex = new RegExp(this.value,'gi')

    // æŠŠç¬¦åˆçš„æ–‡å­—é«˜äº®
    const stationName = place.Station_Name.replace(regex, `<span class="hl">${this.value}</span>`)
    const address = place.ä½å€.replace(regex, `<span class="hl">${this.value}</span>`)
    const webName = place.ç¶²ç«™ä¸­æ–‡ç«™å.replace(regex, `<span class="hl">${this.value}</span>`)

    return `
      <li>
        <span class="name">${stationName}, ${webName}, ${address}</span>
        <span class="population">${place.é›»è©±}</span>
      </li>
    `
  }).join('')

  suggestions.innerHTML = html
}

const searchInput = document.querySelector('.search')
const suggestions = document.querySelector('.suggestions')

searchInput.addEventListener('change',displayMatches)
searchInput.addEventListener('keyup',displayMatches)



</script>
</body>
</html>
